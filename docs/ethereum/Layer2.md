# Layer2

## 1. 简介
“Layer1 来保证安全和去中心化，绝对可靠、可信；它能做到全球共识，并作为「加密法院」，通过智能合约设计的规则进行仲裁，以经济激励的形式将信任传递到 Layer2 上。而 Layer2 追求极致的性能，它只能做到局部共识，但是能够满足各类商业场景的需求。“ --ckb 的设计思想

## 2. 以太坊 L2 的进化路线：rollup 是阶段性的终点
以太坊的扩容路线有两条，一条是链上扩容，主要使用分片技术，是 ETH 2.0的目标之一。然而，分片的技术困难非常大，ETH 一开始目标是做1024个分片，后来发现太过困难，决定缩减至64个分片。但即使如此，现在离部署64个分片还有一段距离。所幸，以太坊的另一条扩容路线，也就是 Layer 2，已经做出了巨大突破，并且已经有不少项目落地，处在生态爆发前夕。

最先被实现的 layer2 是状态通道 (State Channels)，它可以让两者在常数的 gas 开销下进行无数次交易，但其功用显然十分有限：用户每与一个人交易都需要建立一次链接，而且能做的操作非常有限。其次被实现的就是侧链(也有部分人认为侧链不算 L2)，简单来说就是开辟一条新的、可扩展性更好但是安全性更差的链帮助主链分担计算量。用户可以把一定资产转移到侧链，进行若干次交易之后，再转回主链。侧链的问题是，其安全性得不到保证。与主链相比，侧链缺乏足够的计算能力来维持共识，这就使侧链可能被矿工攻击。

紧接着就是 rollup 方案。Rollup 大致的方法论是，把计算执行过程下放至链下，然后再用零知识证明/欺诈证明的方法，在链上证明正确性。

rollups 主要有四种:
Optimistic Rollups、Zk Rollup、Plasma 和 Validium / Zk porter。

- Plasma (欺诈证明+数据链下储存)
    > Plasma 的性能不高，并且交易数据存在链下，有很大的安全风险。

- Optimistic Rollups (欺诈证明+数据链上储存)
    > Optimistic Rollups 使用和 Plasma 一样的欺诈证明保证合约运行的正确性，并且通过把签名聚合后的原始交易数据上传至 L1 以解决 Plasma 的数据可用性问题。  

    > 开启 Optimistic Rollups 时，账户需要在 L1 中抵押代币。有一批交易需要上链时，需要相关账户对这批交易签名。交易会立刻在 L1 上执行，但是任何账户都可以对这些交易进行挑战，如果挑战成功，作恶的账户的押金会扣除，并

    > 相应的，因为原始交易数据还是被打包上传至L1，原始交易数据的空间占用成为了性能瓶颈，Optimistic Rollups的TPS会比Plasma低不少，但是依然大幅提升了以太坊的可扩展性。

    > 那么，Optimistic Rollups是否有额外安全风险呢？欺诈证明使用经济学保证如果有合约的运行结果有误，那么就会有挑战者将其指出。也就是说，只要还有一个良性节点在检查交易结果，欺诈证明下的Optimistic Rollups的安全性就与L1相同。

[参考资料1](https://mp.weixin.qq.com/s/z5BQXwdg-oiO8NHbRysclg)  
