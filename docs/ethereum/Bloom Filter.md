# Bloom Filter

## 1. 简介
布隆过滤器是一种可以判断某个数据是否存在的数据结构，或者也可以说是判断集合中是否包含某个成员的数据结构。

布隆过滤器的主要特点如下：
- 效率极高
- 偶尔会出错：存在误报，但绝对不会漏报

## 2. 实现原理
布隆过滤器的原理就是当一个元素被加入到集合的时候，用 K 个 Hash 函数将元素映射到一个位图中的 K 个点，并且把这个点的值设置为1，在每次检索的时候我们看一下这个点是不是都是1就知道集合中有没有这个元素了。

举个例子：

我们假设 K 是2，有 Hash1 和 Hash2 两个哈希函数

> Hash1 = n%3  
> Hash2 = n%8

然后我们创建一个名叫 bitMap 长度是20的位图

> bitMap=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

这个时候，我们要将7，存入到这个集合中

n = 7  
分别用 Hash1 和 Hash2 计算 n 哈希后的值

> Hash1  ->  1  
> Hash2  ->  7

我们把 bitMap 对应的值置为1，从0开始

> bitMap=[0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

这样下次我们来查找7在不在这个集合的时候就可以用 Hash1 和 Hash2 计算完以后在 bitMap 集合中查找对应位置是否都是1，如果都是1则一定在集合中。

如果再在集合中插入13，分别用 Hash1 和 Hash2 计算 n 哈希后的值

> n = 13  
> Hash1  ->  1  
> Hash2  ->  5

我们把 bitMap 对应的值置为1，从0开始

> bitMap=[0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

这个时候我们发现1被映射到了两次，但是并不影响我们在集合 [7, 13] 中快速找到7或者13。

但是当插入的数据量大幅提升的时候，甚至 bitMap 全部被置为1的时候问题就很严重了，误识率就非常高了，这个也是根据不同场景实现布隆过滤器所要考虑的问题。

[参考文档1 2021-05-14](https://blog.csdn.net/wcc19840827/article/details/116782838)  
[参考文档2 2019-08-27](https://zhuanlan.zhihu.com/p/64378536)
